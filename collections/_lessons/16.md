---
layout: lesson
title: Lekce 16
subtitle: Úvahy na téma "Nedůvěřuj, ověřuj"
quote: "\"Nyní důkazy,\" řekl král, \"a poté rozsudek.\""
audio: /assets/audio/21lessons/3-16.m4a
image: /assets/images/guix-bootstrap-dependencies.png
order: ch3-16
---

Cílem Bitcoinu je nahradit konvenční měnu nebo k ní alespoň poskytnout 
alternativu. Konvenční měna je vázána na centralizovanou autoritu, ať 
už mluvíme o zákonném platidle, jako je americký dolar, nebo o moderních 
monopolních penězích, jakými jsou V-Bucks ve Fortnite. V obou případech 
jste vázáni důvěrou v centrální autoritu, která vaše peníze vydává, 
spravuje a uvádí do oběhu. Bitcoin tato pouta rozvazuje a hlavním 
problémem, který řeší, je otázka *důvěry*.

> "Základním problémem konvenční měny je důvěra, která je nutná k jejímu 
> fungování. [...] To, co je potřeba, je elektronický platební systém 
> založený na kryptografickém důkazu namísto důvěry"
> <cite>[Satoshi] [Nakamoto]</cite>

Bitcoin řeší problém důvěry tím, že je zcela decentralizovaný, bez 
ústředního serveru nebo důvěryhodných stran. Dokonce ani ne důvěryhodných 
*třetích* stran, ale prostě důvěryhodných stran a tečka. Když neexistuje 
centrální autorita, *není* jednoduše komu věřit. Inovací je úplná 
decentralizace. Ona je podstatou odolnosti Bitcoinu, důvodem, proč je 
stále naživu. Decentralizace je také důvodem, proč máme těžbu, uzly, 
hardwarové peněženky a ano, blockchain. Jediné, čemu musíte "věřit", 
je, že naše chápání matematiky a fyziky není úplně mimo a že [většina] 
těžařů jedná čestně (k čemuž jsou motivováni).

Zatímco v běžném světě platí zásada *"důvěřuj, ale prověřuj"*, u Bitcoinu 
platí zásada *"nedůvěřuj, ověřuj"*. Satoshi velmi jasně zdůraznil důležitost 
odstranění důvěry jak v úvodu, tak v závěru [whitepaperu][Nakamoto].

> "Závěr: Navrhli jsme systém pro elektronické transakce nezávislý na důvěře."
> <cite>[Satoshi Nakamoto][Nakamoto]</cite>

Všimněte si, že výraz "nezávislý na důvěře" je zde použit ve velmi 
specifickém kontextu. Mluvíme o důvěryhodných třetích stranách, 
tj. jiných subjektech, kterým věříte, když produkují, drží 
a zpracovávají vaše peníze. Předpokládá se například, že můžete 
důvěřovat svému počítači.

Jak ukázal Ken Thompson ve své přednášce při udílení Turing Award, 
důvěra je ve světě počítačů velmi ošemetná věc. Při spouštění programu 
musíte důvěřovat nejrůznějšímu softwaru (a hardwaru), jenž by teoreticky 
mohl program, který se snažíte spustit, škodlivým způsobem změnit. 
Jak shrnul Thompson ve svých [*Úvahách o důvěře v důvěru*][]:
"Poučení je zřejmé. Nemůžete důvěřovat kódu, který jste sami zcela 
nevytvořili."

{% include image.html path="./assets/images/ken-thompson-hack.png" %}

Thompson ukázal, že i když máte přístup ke zdrojovému kódu, může být 
váš kompilátor - nebo jakýkoli jiný program či hardware pracující 
s vaším programem - kompromitován a odhalení těchto zadních vrátek 
bude velmi obtížné. V praxi tedy opravdový systém *bez důvěry* neexistuje. 
Veškerý software *a* veškerý hardware (assemblery, kompilátory, linkery 
atd.) byste museli vytvořit sami od začátku, bez pomoci jakéhokoli 
externího softwaru nebo softwarově podporovaných strojů.

> "Chcete-li upéct jablečný koláč od základu, musíte nejprve 
> vymyslet vesmír."
> <cite>[Carl Sagan]</cite>

Hack Kena Thompsona je obzvláště důmyslný a těžko odhalitelný backdoor. 
Pojďme se tedy krátce podívat na těžko odhalitelný backdoor, který 
funguje bez úpravy jakéhokoli softwaru. Výzkumníci [našli způsob], jak 
ohrozit bezpečnostně kritický hardware změnou polarity křemíkových nečistot. 
Pouhou změnou fyzikálních vlastností látky, ze které jsou vyrobeny 
počítačové čipy, se jim podařilo kompromitovat kryptograficky bezpečný 
generátor náhodných čísel. Protože tato změna není vidět, nelze zadní 
vrátka odhalit optickou kontrolou, která je u takových čipů jedním 
z nejdůležitějších mechanismů pro odhalení neoprávněné manipulace.

{% include image.html path="./assets/images/stealthy-hardware-trojan.png" caption="Stealthy Dopant-Level Hardware Trojans by Becker, Regazzoni, Paar, Burleson" %}

Zní to děsivě? No, i kdybyste byli schopni sestavit vše od nuly, stejně 
byste museli věřit základní matematice. Museli byste věřit, že [secp256k1] 
je eliptická křivka bez zadních vrátek. Ano, do matematických základů 
kryptografických funkcí lze vložit škodlivý backdoor a pravděpodobně 
se to již [minimálně jednou stalo]. Existují dobré důvody, proč být 
paranoidní, a skutečnost, že vše od hardwaru přes software až po používané 
eliptické křivky může mít [zadní vrátka], patří mezi ně.

> "Nedůvěřuj. Ověřuj."

The above examples should illustrate that *trustless* computing is
utopic. Bitcoin is probably the one system which comes closest to this
utopia, but still, it is *trust-minimized* --- aiming to remove trust
wherever possible. Arguably, the chain-of-trust is neverending, since
you will also have to trust that computation requires energy, that P
does not equal NP, and that you are actually in base reality and not
imprisoned in a simulation by malicious actors.

Developers are working on tools and procedures to minimize any remaining
trust even further. For example, Bitcoin developers created [Gitian],
which is a software distribution method to create deterministic builds.
The idea is that if multiple developers are able to reproduce identical
binaries, the chance of malicious tampering is reduced. Fancy backdoors
aren't the only attack vector. Simple blackmail or extortion are real
threats as well. As in the main protocol, decentralization is used to
minimize trust.

Various efforts are being made to improve upon the chicken-and-egg
problem of [bootstrapping] which Ken Thompson's hack so brilliantly
pointed out. One such effort is [Guix] (pronounced *geeks*), which uses
functionally declared package management leading to bit-for-bit
reproducible builds by design. The result is that you don't have to
trust any software-providing servers anymore since you can verify that
the served binary was not tampered with by rebuilding it from scratch.
Recently, a [pull-request] was merged to integrate Guix into the Bitcoin build
process.

{% include image.html path="./assets/images/guix-bootstrap-dependencies.png" caption="Which came first, the chicken or the egg?" %}

Luckily, Bitcoin doesn't rely on a single algorithm or piece of
hardware. One effect of Bitcoin's radical decentralization is a
distributed security model. Although the backdoors described above are
not to be taken lightly, it is unlikely that every software wallet,
every hardware wallet, every cryptographic library, every node
implementation, and every compiler of every language is compromised.
Possible, but highly unlikely.

Note that you can generate a private key without relying on any
computational hardware or software. You can [flip a coin] a couple of
times, although depending on your coin and tossing style this source of
randomness might not be sufficiently random. There is a reason why
storage protocols like [Glacier] advise to use casino-grade dice as one
of two sources of entropy.

Bitcoin forced me to reflect on what trusting nobody actually entails.
It raised my awareness of the bootstrapping problem, and the implicit
chain-of-trust in developing and running software. It also raised my
awareness of the many ways in which software and hardware can be
compromised.

Bitcoin taught me not to trust, but to verify.

---

{% include links.html lesson=16 %}

[Emmanuel Boutet]: https://commons.wikimedia.org/wiki/User:Emmanuel.boutet
[Satoshi]: http://p2pfoundation.ning.com/forum/topics/bitcoin-open-source
[Nakamoto]: https://bitcoin.org/bitcoin.pdf
[*Reflections on Trusting Trust*]: https://www.archive.ece.cmu.edu/~ganger/712.fall02/papers/p761-thompson.pdf
[found a way]: https://scholar.google.com/scholar?hl=en&as_sdt=0%2C5&q=Stealthy+Dopant-Level+Hardware+Trojans&btnG=
[Gitian]: https://gitian.org/
[bootstrapping]: https://www.gnu.org/software/guix/manual/en/html_node/Bootstrapping.html
[Guix]: https://www.gnu.org/software/guix/
[pull-request]: https://github.com/bitcoin/bitcoin/pull/15277
[flip a coin]: https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch04.asciidoc#private-keys
[Glacier]: https://glacierprotocol.org/
[secp256k1]: https://en.bitcoin.it/wiki/Secp256k1
[majority]: https://bitcoin.org/en/developer-guide#term-51-attack

<!-- Wikipedia -->
[backdoors]: https://en.wikipedia.org/wiki/Elliptic-curve_cryptography#Backdoors
[has already happened]: https://en.wikipedia.org/wiki/Dual_EC_DRBG
[Carl Sagan]: https://en.wikipedia.org/wiki/Cosmos_%28Carl_Sagan_book%29
[alice]: https://en.wikipedia.org/wiki/Alice%27s_Adventures_in_Wonderland
[carroll]: https://en.wikipedia.org/wiki/Lewis_Carroll
